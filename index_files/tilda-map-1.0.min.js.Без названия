function t_appendGoogleMap(recid,key){var grecid=recid;if("object"==typeof google&&"object"==typeof google.maps)t_handleGoogleApiReady(grecid);else if(!0!==window.googleapiiscalled){var runfunc="window.t_handleGoogleApiReady_"+grecid+' = function () { t_handleGoogleApiReady("'+grecid+'") }';eval(runfunc);var addParams="",maplang="";maplang=$("#rec"+recid).find(".t-map").data("map-language"),""<maplang&&2==maplang.length&&(addParams="&language="+maplang);var script=document.createElement("script");script.type="text/javascript",script.src="https://maps.google.com/maps/api/js?key="+jQuery.trim(key)+"&callback=t_handleGoogleApiReady_"+grecid+addParams,document.body.appendChild(script),window.googleapiiscalled=!0}else setTimeout(function(){t_appendGoogleMap(grecid,key)},200)}function t_handleGoogleApiReady(recid){$("#rec"+recid).find(".t-map").each(function(index,Element){var el=$(Element),arMarkers=window["arMapMarkers"+recid],mapstyle="[]";window.isDragMap=!window.isMobile,""!=el.attr("data-map-style")&&(mapstyle=eval(el.attr("data-map-style")));var myLatLng=0<arMarkers.length&&new google.maps.LatLng(parseFloat(arMarkers[0].lat),parseFloat(arMarkers[0].lng)),myOptions={zoom:parseInt(el.attr("data-map-zoom")),center:myLatLng,scrollwheel:!1,gestureHandling:"cooperative",zoomControl:!0,styles:mapstyle},map=new google.maps.Map(Element,myOptions),i,mrk,marker,markers=[],bounds=new google.maps.LatLngBounds;for(i in arMarkers)mrk=arMarkers[i],myLatLng=new google.maps.LatLng(parseFloat(mrk.lat),parseFloat(mrk.lng)),marker=new google.maps.Marker({position:myLatLng,map:map,title:mrk.title}),bounds.extend(myLatLng),""<mrk.descr?attachInfoMessage(marker,mrk.descr):attachInfoMessage(marker,mrk.title),markers[markers.length]=marker,marker="";function attachInfoMessage(e,a){var t=new google.maps.InfoWindow({content:$("<textarea/>").html(a).text()});e.addListener("click",function(){t.open(e.get("map"),e)})}if(1<arMarkers.length){map.fitBounds(bounds);var listener=google.maps.event.addListener(map,"idle",function(){(map.getZoom()>parseInt(el.attr("data-map-zoom"))||0==map.getZoom())&&map.setZoom(parseInt(el.attr("data-map-zoom"))),16<map.getZoom()&&map.setZoom(16),google.maps.event.removeListener(listener)})}google.maps.event.addDomListener(window,"resize",function(){var e=map.getCenter(),a=parseInt(el.attr("data-map-zoom"));google.maps.event.trigger(map,"resize"),map.setCenter(e),0<arMarkers.length&&(map.fitBounds(bounds),0<a&&(map.getZoom()>a||0==map.getZoom())&&map.setZoom(a))}),el.on("displayChanged",function(){google.maps.event.trigger(map,"resize")}),el.on("sizechange",function(){google.maps.event.trigger(map,"resize")})})}function t_appendYandexMap(recid,key){var yarecid=recid;if("object"==typeof ymaps&&"function"==typeof ymaps.Map)t_handleYandexApiReady(recid);else if(!0!==window.yandexmapsapiiscalled){var runfunc="window.t_handleYandexApiReady_"+yarecid+' = function () { return t_handleYandexApiReady("'+yarecid+'") }',maplang;eval(runfunc),maplang=$("#rec"+recid).find(".t-map").data("map-language"),maplang=maplang&&"EN"==maplang?"en_US":"ru_RU";var script=document.createElement("script");script.type="text/javascript",script.src="https://api-maps.yandex.ru/2.1/?lang="+maplang+"&coordorder=latlong&onload=t_handleYandexApiReady_"+yarecid,""<key&&(script.src=script.src+"&apikey="+key),document.body.appendChild(script),window.yandexmapsapiiscalled=!0}else setTimeout(function(){t_appendYandexMap(yarecid,key)},200)}function t_handleYandexApiReady(u){$("#rec"+u).find(".t-map").each(function(e,a){var t=$(a),n=window["arMapMarkers"+u];window.isDragMap=!window.isMobile;var o,r,i=0<n.length&&[parseFloat(n[0].lat),parseFloat(n[0].lng)],s={zoom:parseInt(t.attr("data-map-zoom")),center:i,scrollZoom:!1,controls:["typeSelector","zoomControl"],drag:window.isDragMap},p=new ymaps.Map(a,s),l=new ymaps.GeoObjectCollection({}),d=p.panes.get("events").getElement(),m={en:"Use two fingers to move the map",ru:"Чтобы переместить карту проведите по ней двумя пальцами",uk:"Переміщуйте карту двома пальцями",be:"Каб перамясціць карту, перацягніце яе двума пальцамі",kk:"Картаны екі саусақпен жылжытыңыз",zh:"使用双指移动地图"},g={alignItems:"center",boxSizing:"border-box",color:"white",display:"flex",justifyContent:"center",fontSize:"22px",fontFamily:"Arial,sans-serif",opacity:"0.0",padding:"25px",textAlign:"center",transition:"opacity .3s",touchAction:"auto"};Object.keys(g).forEach(function(e){d.style[e]=g[e]});var c="en";for(o in window.navigator&&(c=(window.navigator.language||window.navigator.systemLanguage||window.navigator.userLanguage).substr(0,2)),p.behaviors.disable("scrollZoom"),window.isMobile&&(p.behaviors.disable("drag"),ymaps.domEvent.manager.add(d,"touchmove",function(e){1===e.get("touches").length&&(d.style.transition="opacity .3s",d.style.background="rgba(0, 0, 0, .45)",d.textContent=m[c]||m.en,d.style.opacity="1")}),ymaps.domEvent.manager.add(d,"touchend",function(){d.style.transition="opacity .8s",d.style.opacity="0"})),n)r=n[o],i=[parseFloat(r.lat),parseFloat(r.lng)],l.add(new ymaps.Placemark(i,{hintContent:r.title,balloonContent:""<r.descr?$("<textarea/>").html(r.descr).text():r.title}));if(p.geoObjects.add(l),1<n.length){p.setBounds(l.getBounds(),{checkZoomRange:!0});var y=parseInt(t.attr("data-map-zoom"));0<y&&(0==p.getZoom()||p.getZoom()>y)&&p.setZoom(y)}p.events.add("sizechange",function(){var e=p.container.getParentElement(),a=parseInt($(e).attr("data-map-zoom"));p.container.fitToViewport(),1<n.length&&p.setBounds(l.getBounds(),{checkZoomRange:!0}),0<a&&(0==p.getZoom()||p.getZoom()>a)&&p.setZoom(a)}),t.on("sizechange",function(){p.container.fitToViewport()})})}